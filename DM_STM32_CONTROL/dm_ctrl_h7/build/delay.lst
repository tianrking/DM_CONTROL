ARM GAS  /tmp/ccuPLAez.s 			page 1


   1              		.cpu cortex-m7
   2              		.eabi_attribute 28, 1
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 1
  10              		.eabi_attribute 34, 1
  11              		.eabi_attribute 18, 4
  12              		.file	"delay.c"
  13              		.text
  14              	.Ltext0:
  15              		.cfi_sections	.debug_frame
  16              		.section	.text.delay_init,"ax",%progbits
  17              		.align	1
  18              		.global	delay_init
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv5-d16
  25              	delay_init:
  26              	.LVL0:
  27              	.LFB144:
  28              		.file 1 "User/delay.c"
   1:User/delay.c  **** #include "delay.h"
   2:User/delay.c  **** 
   3:User/delay.c  **** static uint32_t fac_us = 0;
   4:User/delay.c  **** 
   5:User/delay.c  **** void delay_init(uint16_t SYSCLK)
   6:User/delay.c  **** {
  29              		.loc 1 6 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		.loc 1 6 1 is_stmt 0 view .LVU1
  34 0000 10B5     		push	{r4, lr}
  35              	.LCFI0:
  36              		.cfi_def_cfa_offset 8
  37              		.cfi_offset 4, -8
  38              		.cfi_offset 14, -4
  39 0002 0446     		mov	r4, r0
   7:User/delay.c  **** 	HAL_SYSTICK_CLKSourceConfig(SYSTICK_CLKSOURCE_HCLK);
  40              		.loc 1 7 2 is_stmt 1 view .LVU2
  41 0004 0420     		movs	r0, #4
  42              	.LVL1:
  43              		.loc 1 7 2 is_stmt 0 view .LVU3
  44 0006 FFF7FEFF 		bl	HAL_SYSTICK_CLKSourceConfig
  45              	.LVL2:
   8:User/delay.c  **** 	fac_us = SYSCLK;	
  46              		.loc 1 8 2 is_stmt 1 view .LVU4
  47              		.loc 1 8 9 is_stmt 0 view .LVU5
  48 000a 014B     		ldr	r3, .L3
  49 000c 1C60     		str	r4, [r3]
   9:User/delay.c  **** }
ARM GAS  /tmp/ccuPLAez.s 			page 2


  50              		.loc 1 9 1 view .LVU6
  51 000e 10BD     		pop	{r4, pc}
  52              	.L4:
  53              		.align	2
  54              	.L3:
  55 0010 00000000 		.word	.LANCHOR0
  56              		.cfi_endproc
  57              	.LFE144:
  59              		.section	.text.delay_us,"ax",%progbits
  60              		.align	1
  61              		.global	delay_us
  62              		.syntax unified
  63              		.thumb
  64              		.thumb_func
  65              		.fpu fpv5-d16
  67              	delay_us:
  68              	.LVL3:
  69              	.LFB145:
  10:User/delay.c  **** void delay_us(uint32_t nus)
  11:User/delay.c  **** {		
  70              		.loc 1 11 1 is_stmt 1 view -0
  71              		.cfi_startproc
  72              		@ args = 0, pretend = 0, frame = 0
  73              		@ frame_needed = 0, uses_anonymous_args = 0
  74              		@ link register save eliminated.
  75              		.loc 1 11 1 is_stmt 0 view .LVU8
  76 0000 10B4     		push	{r4}
  77              	.LCFI1:
  78              		.cfi_def_cfa_offset 4
  79              		.cfi_offset 4, -4
  12:User/delay.c  **** 	uint32_t ticks;
  80              		.loc 1 12 2 is_stmt 1 view .LVU9
  13:User/delay.c  **** 	uint32_t told, tnow,tcnt = 0;
  81              		.loc 1 13 2 view .LVU10
  82              	.LVL4:
  14:User/delay.c  **** 	uint32_t reload = SysTick->LOAD;					    	 
  83              		.loc 1 14 2 view .LVU11
  84              		.loc 1 14 11 is_stmt 0 view .LVU12
  85 0002 4FF0E022 		mov	r2, #-536813568
  86 0006 5469     		ldr	r4, [r2, #20]
  87              	.LVL5:
  15:User/delay.c  **** 	ticks = nus * fac_us; 						
  88              		.loc 1 15 2 is_stmt 1 view .LVU13
  89              		.loc 1 15 14 is_stmt 0 view .LVU14
  90 0008 0C4B     		ldr	r3, .L12
  91 000a 1B68     		ldr	r3, [r3]
  92              		.loc 1 15 8 view .LVU15
  93 000c 00FB03FC 		mul	ip, r0, r3
  94              	.LVL6:
  16:User/delay.c  **** 	told = SysTick->VAL;        				
  95              		.loc 1 16 2 is_stmt 1 view .LVU16
  96              		.loc 1 16 7 is_stmt 0 view .LVU17
  97 0010 9369     		ldr	r3, [r2, #24]
  98              	.LVL7:
  13:User/delay.c  **** 	uint32_t reload = SysTick->LOAD;					    	 
  99              		.loc 1 13 22 view .LVU18
 100 0012 0021     		movs	r1, #0
ARM GAS  /tmp/ccuPLAez.s 			page 3


 101 0014 04E0     		b	.L9
 102              	.LVL8:
 103              	.L7:
  17:User/delay.c  **** 	while(1)
  18:User/delay.c  **** 	{
  19:User/delay.c  **** 		tnow = SysTick->VAL;	
  20:User/delay.c  **** 		if(tnow != told)
  21:User/delay.c  **** 		{	    
  22:User/delay.c  **** 			if(tnow < told)
  23:User/delay.c  **** 			{
  24:User/delay.c  **** 				tcnt += told-tnow;
  25:User/delay.c  **** 			}			
  26:User/delay.c  **** 			else 
  27:User/delay.c  **** 			{
  28:User/delay.c  **** 				tcnt += reload - tnow + told;
 104              		.loc 1 28 5 is_stmt 1 view .LVU19
 105              		.loc 1 28 20 is_stmt 0 view .LVU20
 106 0016 E01A     		subs	r0, r4, r3
 107              		.loc 1 28 27 view .LVU21
 108 0018 0244     		add	r2, r2, r0
 109              	.LVL9:
 110              		.loc 1 28 10 view .LVU22
 111 001a 1144     		add	r1, r1, r2
 112              	.LVL10:
 113              	.L8:
  29:User/delay.c  **** 			}	    
  30:User/delay.c  **** 			told = tnow;
 114              		.loc 1 30 4 is_stmt 1 view .LVU23
  31:User/delay.c  **** 			if(tcnt >= ticks)
 115              		.loc 1 31 4 view .LVU24
 116              		.loc 1 31 6 is_stmt 0 view .LVU25
 117 001c 6145     		cmp	r1, ip
 118 001e 09D2     		bcs	.L11
 119              	.LVL11:
 120              	.L9:
  13:User/delay.c  **** 	uint32_t reload = SysTick->LOAD;					    	 
 121              		.loc 1 13 22 view .LVU26
 122 0020 1A46     		mov	r2, r3
 123              	.LVL12:
 124              	.L6:
  17:User/delay.c  **** 	{
 125              		.loc 1 17 2 is_stmt 1 view .LVU27
  19:User/delay.c  **** 		if(tnow != told)
 126              		.loc 1 19 3 view .LVU28
  19:User/delay.c  **** 		if(tnow != told)
 127              		.loc 1 19 8 is_stmt 0 view .LVU29
 128 0022 4FF0E023 		mov	r3, #-536813568
 129 0026 9B69     		ldr	r3, [r3, #24]
 130              	.LVL13:
  20:User/delay.c  **** 		{	    
 131              		.loc 1 20 3 is_stmt 1 view .LVU30
  20:User/delay.c  **** 		{	    
 132              		.loc 1 20 5 is_stmt 0 view .LVU31
 133 0028 9A42     		cmp	r2, r3
 134 002a FAD0     		beq	.L6
  22:User/delay.c  **** 			{
 135              		.loc 1 22 4 is_stmt 1 view .LVU32
ARM GAS  /tmp/ccuPLAez.s 			page 4


  22:User/delay.c  **** 			{
 136              		.loc 1 22 6 is_stmt 0 view .LVU33
 137 002c F3D9     		bls	.L7
  24:User/delay.c  **** 			}			
 138              		.loc 1 24 5 is_stmt 1 view .LVU34
  24:User/delay.c  **** 			}			
 139              		.loc 1 24 17 is_stmt 0 view .LVU35
 140 002e D21A     		subs	r2, r2, r3
 141              	.LVL14:
  24:User/delay.c  **** 			}			
 142              		.loc 1 24 10 view .LVU36
 143 0030 1144     		add	r1, r1, r2
 144              	.LVL15:
  24:User/delay.c  **** 			}			
 145              		.loc 1 24 10 view .LVU37
 146 0032 F3E7     		b	.L8
 147              	.LVL16:
 148              	.L11:
  32:User/delay.c  **** 			{
  33:User/delay.c  **** 				break;	
  34:User/delay.c  **** 			}			
  35:User/delay.c  **** 		}  
  36:User/delay.c  **** 	};
  37:User/delay.c  **** }
 149              		.loc 1 37 1 view .LVU38
 150 0034 5DF8044B 		ldr	r4, [sp], #4
 151              	.LCFI2:
 152              		.cfi_restore 4
 153              		.cfi_def_cfa_offset 0
 154              	.LVL17:
 155              		.loc 1 37 1 view .LVU39
 156 0038 7047     		bx	lr
 157              	.L13:
 158 003a 00BF     		.align	2
 159              	.L12:
 160 003c 00000000 		.word	.LANCHOR0
 161              		.cfi_endproc
 162              	.LFE145:
 164              		.section	.text.delay_ms,"ax",%progbits
 165              		.align	1
 166              		.global	delay_ms
 167              		.syntax unified
 168              		.thumb
 169              		.thumb_func
 170              		.fpu fpv5-d16
 172              	delay_ms:
 173              	.LVL18:
 174              	.LFB146:
  38:User/delay.c  **** 
  39:User/delay.c  **** void delay_ms(uint32_t ms)
  40:User/delay.c  **** {
 175              		.loc 1 40 1 is_stmt 1 view -0
 176              		.cfi_startproc
 177              		@ args = 0, pretend = 0, frame = 0
 178              		@ frame_needed = 0, uses_anonymous_args = 0
 179              		.loc 1 40 1 is_stmt 0 view .LVU41
 180 0000 10B5     		push	{r4, lr}
ARM GAS  /tmp/ccuPLAez.s 			page 5


 181              	.LCFI3:
 182              		.cfi_def_cfa_offset 8
 183              		.cfi_offset 4, -8
 184              		.cfi_offset 14, -4
 185 0002 0446     		mov	r4, r0
  41:User/delay.c  **** 	for(int i = ms; i > 0; i--)
 186              		.loc 1 41 2 is_stmt 1 view .LVU42
 187              	.LBB2:
 188              		.loc 1 41 6 view .LVU43
 189              	.LVL19:
 190              		.loc 1 41 2 is_stmt 0 view .LVU44
 191 0004 04E0     		b	.L15
 192              	.LVL20:
 193              	.L16:
  42:User/delay.c  **** 	{
  43:User/delay.c  **** 		delay_us(1000);
 194              		.loc 1 43 3 is_stmt 1 discriminator 3 view .LVU45
 195 0006 4FF47A70 		mov	r0, #1000
 196 000a FFF7FEFF 		bl	delay_us
 197              	.LVL21:
  41:User/delay.c  **** 	for(int i = ms; i > 0; i--)
 198              		.loc 1 41 25 discriminator 3 view .LVU46
  41:User/delay.c  **** 	for(int i = ms; i > 0; i--)
 199              		.loc 1 41 26 is_stmt 0 discriminator 3 view .LVU47
 200 000e 013C     		subs	r4, r4, #1
 201              	.LVL22:
 202              	.L15:
  41:User/delay.c  **** 	for(int i = ms; i > 0; i--)
 203              		.loc 1 41 18 is_stmt 1 discriminator 1 view .LVU48
  41:User/delay.c  **** 	for(int i = ms; i > 0; i--)
 204              		.loc 1 41 2 is_stmt 0 discriminator 1 view .LVU49
 205 0010 002C     		cmp	r4, #0
 206 0012 F8DC     		bgt	.L16
  41:User/delay.c  **** 	for(int i = ms; i > 0; i--)
 207              		.loc 1 41 2 discriminator 1 view .LVU50
 208              	.LBE2:
  44:User/delay.c  **** 	}
  45:User/delay.c  **** }
 209              		.loc 1 45 1 view .LVU51
 210 0014 10BD     		pop	{r4, pc}
 211              		.loc 1 45 1 view .LVU52
 212              		.cfi_endproc
 213              	.LFE146:
 215              		.section	.bss.fac_us,"aw",%nobits
 216              		.align	2
 217              		.set	.LANCHOR0,. + 0
 220              	fac_us:
 221 0000 00000000 		.space	4
 222              		.text
 223              	.Letext0:
 224              		.file 2 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stdint.h"
 225              		.file 3 "Drivers/CMSIS/Include/core_cm7.h"
 226              		.file 4 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_cortex.h"
ARM GAS  /tmp/ccuPLAez.s 			page 6


DEFINED SYMBOLS
                            *ABS*:0000000000000000 delay.c
     /tmp/ccuPLAez.s:17     .text.delay_init:0000000000000000 $t
     /tmp/ccuPLAez.s:25     .text.delay_init:0000000000000000 delay_init
     /tmp/ccuPLAez.s:55     .text.delay_init:0000000000000010 $d
     /tmp/ccuPLAez.s:60     .text.delay_us:0000000000000000 $t
     /tmp/ccuPLAez.s:67     .text.delay_us:0000000000000000 delay_us
     /tmp/ccuPLAez.s:160    .text.delay_us:000000000000003c $d
     /tmp/ccuPLAez.s:165    .text.delay_ms:0000000000000000 $t
     /tmp/ccuPLAez.s:172    .text.delay_ms:0000000000000000 delay_ms
     /tmp/ccuPLAez.s:216    .bss.fac_us:0000000000000000 $d
     /tmp/ccuPLAez.s:220    .bss.fac_us:0000000000000000 fac_us

UNDEFINED SYMBOLS
HAL_SYSTICK_CLKSourceConfig
